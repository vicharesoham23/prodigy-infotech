from PIL import Image


def encrypt_image(image_path, key, output_path):
    image = Image.open(image_path)
    pixels = image.load()

    width, height = image.size

    for x in range(width):
        for y in range(height):
            r, g, b = pixels[x, y]

            # Encrypt pixel using key
            r = (r + key) % 256
            g = (g + key) % 256
            b = (b + key) % 256

            pixels[x, y] = (r, g, b)

    image.save(output_path)
    print("Image encrypted successfully!")


def decrypt_image(image_path, key, output_path):
    image = Image.open(image_path)
    pixels = image.load()

    width, height = image.size

    for x in range(width):
        for y in range(height):
            r, g, b = pixels[x, y]

            # Decrypt pixel using key
            r = (r - key) % 256
            g = (g - key) % 256
            b = (b - key) % 256

            pixels[x, y] = (r, g, b)

    image.save(output_path)
    print("Image decrypted successfully!")


def main():
    print("=== Image Encryption Tool ===")
    print("1. Encrypt Image")
    print("2. Decrypt Image")

    choice = input("Choose an option (1 or 2): ")

    image_path = input("Enter image path: ")
    key = int(input("Enter secret key (0-255): "))
    output_path = input("Enter output image path: ")

    if choice == "1":
        encrypt_image(image_path, key, output_path)
    elif choice == "2":
        decrypt_image(image_path, key, output_path)
    else:
        print("Invalid choice!")


if __name__ == "__main__":
    main()
